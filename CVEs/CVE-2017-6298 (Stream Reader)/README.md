# CVE-2017-6298 (Yeraze's TNEF Stream Reader)

## Installing The Vulnerable Version

1. We clone the repository:

```C
git clone https://github.com/Yeraze/ytnef.git StreamReader
```

2. We navigate into the project directory:

```C
cd StreamReader/
```

3. We find the commit related to the vulnerability (using the first 7 characters of the commit ID provided above). I would like to view the 5 lines before and after the concerned commit for better context:

```C
git log --graph --oneline --all | grep -B 5 -A 5 "f816ba5"
```

> |  * 12326ac fix another invalid write and huge allocation
> 
> |  * e2d39bd prevent 32 bit system int overflow
> 
> |  * dac0320 prevent out of bound reads
> 
> |  * cc6a49e increase version field, otherwise TNEFVersion might generate a buffer overflow and use snprintf to avoid this in the future
> 
> |  * 4f4598d avoid infinite loop for malicious input files
> 
> |  * **f816ba5** Do a quickfix to check for bad allocations
> 
> |/
> 
> *   86df793 Merge pull request #25 from Yeraze/release/1.9
>   
> |\  
> |  * 57e9683 Prepare for 1.9 Release.
> |/ 

Now, we should see the commit `f816ba5` for **CVE-2017-6298**.

4. We `checkout` the commit before the patch to retrieve the vulnerable version. Note that we checkout the `86df793` commit, not the `4f4598d` commit, because the git graph is read vertically from bottom to top:

```C
git checkout 86df793
```

Eventually, we have the vulnerable version of **Yeraze's TNEF Stream Reader** before the fix for **CVE-2017-6298** was applied. Now, we are ready to dive in.





