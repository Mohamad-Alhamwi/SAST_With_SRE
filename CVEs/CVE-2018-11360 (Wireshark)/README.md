# CVE-2018-11360 (Wireshark)

## Installing The Vulnerable Version

1. We clone the repository:

```C
git clone https://gitlab.com/wireshark/wireshark.git Wireshark
```

2. We navigate into the project directory:

```C
cd Wireshark
```

3. We find the commit related to the vulnerability (using the first 7 characters of the commit ID provided above). I would like to view the 5 lines before and after the concerned commit for better context:

```C
git log --graph --oneline --all | grep -B 5 -A 5 "a55b36c"
```

> | * ee971ce1da Make the two file type descriptions for WTAP_FILE_TYPE_SUBTYPE_MPLOG the same.
> 
> | * 6647728d79 [Automatic update for 2018-05-20]
> 
> | * af6e6237f4 Get rid of add_async_dns_ipv4().
>
> | * 2f56988f01 Make private variables static.
>
> | * beaebe91b1 proto.c: do not dereference a NULL pointer in proto_item_get_len() on first pass
>
> | * **a55b36c51f** gsm_a_dtap: fix off-by-one buffer overflow (write)
>
> | * ab8a33ef08 tvbuff: make tvb_bytes_exist fail with negative values
>
> | * 4425716ddb dns: fix null pointer deref for empty name in SRV record
>
> | * 5f8bd0c94f DNS: replace g_strsplit by wmem_strsplit
>
> | * ccb1ac3c8c Q.931: fix use-after-free (write) of "q931_pi"
>
> | * 14f1a1d749 [Automatic update for 2018-05-13]

Now, we should see the commit `a55b36c` for **CVE-2018-11360**.

4. We `checkout` the commit before the patch to retrieve the vulnerable version. Note that we `checkout` the `ab8a33ef08` commit, not the `beaebe91b1` commit, because the git graph is read vertically from bottom to top:

```C
git checkout ab8a33ef08
```

Eventually, we have the vulnerable version of **Wireshark** before the fix for **CVE-2018-11360** was applied. Now, we are ready to dive in.






